<script>
  document.getElementById("formAgenda").addEventListener("submit", async function (e) {
    e.preventDefault();

    const responsavel = document.getElementById("responsavel").value;
    const bloco = document.getElementById("bloco").value;
    const apartamento = document.getElementById("apartamento").value;
    const recebimento = document.getElementById("recebimento").value;
    const entrega = document.getElementById("entrega").value;

    const dados = {
      responsavel,
      apartamento: bloco + apartamento, // Exemplo: "A101"
      recebimento,
      entrega
    };

    try {
      const resposta = await fetch("https://script.google.com/macros/s/AKfycbwJ6-QNvpyRcYnPg54SV8ZhxiMFAihKS2e72SwQr_tIvhz2_m0v9GB6vUtvlwPN4iEB/exec", {
        method: "POST",
        body: JSON.stringify(dados),
        headers: {
          "Content-Type": "application/json",
        },
      });

      const resultado = await resposta.json();

      if (resultado.status === "sucesso") {
        alert("Cadastro realizado com sucesso!");
        document.getElementById("formAgenda").reset();
      } else {
        alert("Erro ao enviar dados: " + resultado.mensagem);
      }
    } catch (erro) {
      alert("Erro ao enviar dados: " + erro.message);
    }
  });
</script>
